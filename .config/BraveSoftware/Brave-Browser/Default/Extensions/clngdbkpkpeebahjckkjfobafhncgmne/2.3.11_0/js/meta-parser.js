"use strict";{const e=self;(()=>{var t={766:module=>{module.exports=["em","ex","cap","ch","ic","rem","lh","rlh","vw","vh","vi","vb","vmin","vmax","cm","mm","Q","in","pt","pc","px","deg","grad","rad","turn","s","ms","Hz","kHz","dpi","dpcm","dppx","%"]},988:(module,e,t)=>{const util=t(228),{ParseError}=t(170),{parse,createParser}=t(11),{stringify,createStringifier}=t(93);module.exports={ParseError,util,parse,createParser,stringify,createStringifier}},170:module=>{class ParseError extends Error{constructor(err){super(err.message),delete err.message,this.name="ParseError",Object.assign(this,err)}}module.exports={ParseError,MissingCharError:class extends ParseError{constructor(chars,index){super({code:"missingChar",args:chars,message:`Missing character: ${chars.map(e=>`'${e}'`).join(", ")}`,index})}},EOFError:class extends ParseError{constructor(index){super({code:"EOF",message:"Unexpected end of file",index})}}}},291:module=>{function range(amount){const range=Array(amount);for(let e=0;e<amount;e++)range[e]=e;return range}module.exports={LevenshteinDistanceWithMax:function(firstString,secondString,maxEdit){const lenOne=firstString.length,lenTwo=secondString.length;if(Math.abs(lenOne-lenTwo)>maxEdit)return!1;let prevRowDistance=range(lenOne+1),currentRowDistance=Array(lenOne+1);for(let e=1;e<=lenTwo;e++){currentRowDistance[0]=e;let minDistance=e;for(let t=1;t<=lenOne;t++){currentRowDistance[t]=Math.min(prevRowDistance[t]+1,currentRowDistance[t-1]+1,prevRowDistance[t-1]+(firstString[t-1]===secondString[e-1]?0:1)),currentRowDistance[t]<minDistance&&(minDistance=currentRowDistance[t])}if(minDistance>maxEdit)return!1;const vtemp=currentRowDistance;currentRowDistance=prevRowDistance,prevRowDistance=vtemp}return prevRowDistance[lenOne]<=maxEdit}}},228:(module,e,t)=>{const{ParseError,MissingCharError,EOFError}=t(170),RX_EOT=/<<<EOT([\s\S]+?)EOT;/y,RX_LINE=/.*/y,RX_NUMBER=/-?(\d+(\.\d+)?|\.\d+)([eE]-?\d+)?\s*/y,RX_WHITESPACE=/\s*/y,RX_WHITESPACE_SAMELINE=/[^\S\n]*/y,RX_WORD=/([\w-]+)\s*/y,RX_STRING_BACKTICK=/(`(?:\\`|[\s\S])*?`)/y,RX_STRING_QUOTED=/((['"])(?:\\\2|[^\n])*?\2|\w+)/y,RX_STRING_UNQUOTED=/[^"]*/y,RX_VERSION=/^v?\d+(\.\d+)*(?:-(\w[-\w]*(\.[-\w]+)*))?(?:\+(\w[-\w]*(\.[-\w]+)*))?$/,JSON_PRIME={__proto__:null,null:null,true:!0,false:!1};function unescapeComment(e){return e.replace(/\*\\\//g,"*/")}function unquote(e){const t=e[0];return t!==e[e.length-1]||'"'!==t&&"'"!==t&&"`"!==t?unescapeComment(e):e.slice(1,-1).replace(new RegExp(`\\\\([${t}\\\\/bfnrt]|u[0-9a-fA-F]{4})`,"g"),e=>e[1]===t?t:JSON.parse(`"${e}"`))}function eatWhitespace(state){RX_WHITESPACE.lastIndex=state.lastIndex,state.lastIndex+=RX_WHITESPACE.exec(state.text)[0].length}function eatSameLineWhitespace(state){RX_WHITESPACE_SAMELINE.lastIndex=state.lastIndex,state.lastIndex+=RX_WHITESPACE_SAMELINE.exec(state.text)[0].length}function parseWord(state){const pos=state.lastIndex;RX_WORD.lastIndex=pos;const match=RX_WORD.exec(state.text);if(!match)throw new ParseError({code:"invalidWord",message:"Invalid word",index:pos});state.index=pos,state.value=match[1],state.lastIndex+=match[0].length}function parseString(state,sameLine=!1){const pos=state.lastIndex,e="`"===state.text[pos]?RX_STRING_BACKTICK:RX_STRING_QUOTED;e.lastIndex=pos;const match=e.exec(state.text);if(!match)throw new ParseError({code:"invalidString",message:"Invalid string",index:pos});state.index=pos,state.lastIndex+=match[0].length,state.value=unquote(match[1]),sameLine?eatSameLineWhitespace(state):eatWhitespace(state)}function parseJSONValue(state){const{text}=state;if("{"===text[state.lastIndex]){const object={};for(state.lastIndex++,eatWhitespace(state);"}"!==text[state.lastIndex];){parseString(state);const key=state.value;if(":"!==text[state.lastIndex])throw new MissingCharError([":"],state.lastIndex);if(state.lastIndex++,eatWhitespace(state),parseJSONValue(state),object[key]=state.value,","===text[state.lastIndex])state.lastIndex++,eatWhitespace(state);else if("}"!==text[state.lastIndex])throw new MissingCharError([",","}"],state.lastIndex)}state.lastIndex++,eatWhitespace(state),state.value=object}else if("["===text[state.lastIndex]){const array=[];for(state.lastIndex++,eatWhitespace(state);"]"!==text[state.lastIndex];)if(parseJSONValue(state),array.push(state.value),","===text[state.lastIndex])state.lastIndex++,eatWhitespace(state);else if("]"!==text[state.lastIndex])throw new MissingCharError([",","]"],state.lastIndex);state.lastIndex++,eatWhitespace(state),state.value=array}else if('"'===text[state.lastIndex]||"'"===text[state.lastIndex]||"`"===text[state.lastIndex])parseString(state);else if(/[-\d.]/.test(text[state.lastIndex]))parseNumber(state);else{if(parseWord(state),!(state.value in JSON_PRIME))throw new ParseError({code:"unknownJSONLiteral",args:[state.value],message:`Unknown literal '${state.value}'`,index:state.index});state.value=JSON_PRIME[state.value]}}function parseNumber(state){const pos=state.lastIndex;RX_NUMBER.lastIndex=pos;const match=RX_NUMBER.exec(state.text);if(!match)throw new ParseError({code:"invalidNumber",message:"Invalid number",index:pos});state.index=pos,state.value=Number(match[0].trim()),state.lastIndex+=match[0].length}module.exports={eatLine:function(state){RX_LINE.lastIndex=state.lastIndex,RX_LINE.exec(state.text),state.lastIndex=RX_LINE.lastIndex},eatWhitespace,parseChar:function(state){if(state.lastIndex>=state.text.length)throw new EOFError(state.lastIndex);state.index=state.lastIndex,state.value=state.text[state.lastIndex],state.lastIndex++,eatWhitespace(state)},parseEOT:function(state){const pos=state.lastIndex;RX_EOT.lastIndex=pos;const match=RX_EOT.exec(state.text);if(!match)throw new ParseError({code:"missingEOT",message:"Missing EOT",index:pos});state.index=pos,state.lastIndex+=match[0].length,state.value=unescapeComment(match[1].trim()),eatWhitespace(state)},parseJSON:function(state){const pos=state.lastIndex;try{parseJSONValue(state)}catch(e){throw e.message=`Invalid JSON: ${e.message}`,e}state.index=pos},parseNumber,parseString,parseStringToEnd:function(state){RX_LINE.lastIndex=state.lastIndex;const value=RX_LINE.exec(state.text)[0].trim();if(!value)throw new ParseError({code:"missingValue",message:"Missing value",index:RX_LINE.lastIndex});state.index=state.lastIndex,state.value=unquote(value),state.lastIndex=RX_LINE.lastIndex},parseStringUnquoted:function(state){RX_STRING_UNQUOTED.lastIndex=state.lastIndex;const match=RX_STRING_UNQUOTED.exec(state.text);state.index=state.lastIndex,state.lastIndex=RX_STRING_UNQUOTED.lastIndex,state.value=match[0].trim().replace(/\s+/g,"-")},parseWord,unquote,isValidVersion:function(version){return RX_VERSION.test(version)}}},11:(module,e,t)=>{const{URL}=t(541),UNITS=t(766),{ParseError,MissingCharError}=t(170),{LevenshteinDistanceWithMax}=t(291),{eatLine,eatWhitespace,parseEOT,parseJSON,parseString,parseStringToEnd,parseStringUnquoted,parseWord,parseChar,isValidVersion}=t(228),UNITS_SET=new Set(UNITS),DEFAULT_PARSER={name:parseStringToEnd,version:parseStringToEnd,namespace:parseStringToEnd,author:parseStringToEnd,description:parseStringToEnd,homepageURL:parseStringToEnd,supportURL:parseStringToEnd,updateURL:parseStringToEnd,license:parseStringToEnd,preprocessor:parseStringToEnd},DEFAULT_VALIDATOR={version:function(state){if(!isValidVersion(state.value))throw new ParseError({code:"invalidVersion",args:[state.value],message:`Invalid version: ${state.value}`,index:state.valueIndex});state.value=normalizeVersion(state.value)},homepageURL:validateURL,supportURL:validateURL,updateURL:validateURL},DEFAULT_VAR_PARSER={text:parseStringToEnd,color:parseStringToEnd,checkbox:parseChar,select:parseSelect,dropdown:{advanced:parseVarXStyle},image:{var:parseSelect,advanced:parseVarXStyle},number:parseRange,range:parseRange},DEFAULT_VAR_VALIDATOR={checkbox:function(state){if("1"!==state.value&&"0"!==state.value)throw new ParseError({code:"invalidCheckboxDefault",message:"value must be 0 or 1",index:state.valueIndex})},number:validateRange,range:validateRange},MANDATORY_META=["name","namespace","version"],RANGE_PROPS=["default","min","max","step"];function parseRange(state){parseJSON(state);const result={min:null,max:null,step:null,units:null};if("number"==typeof state.value)result.default=state.value;else{if(!Array.isArray(state.value))throw new ParseError({code:"invalidRange",message:"the default value must be an array or a number",index:state.valueIndex,args:[state.type]});{let e=0;for(const item of state.value)if("string"==typeof item){if(null!=result.units)throw new ParseError({code:"invalidRangeMultipleUnits",message:"units is alredy defined",args:[state.type],index:state.valueIndex});result.units=item}else{if("number"!=typeof item&&null!==item)throw new ParseError({code:"invalidRangeValue",message:"value must be number, string, or null",args:[state.type],index:state.valueIndex});if(e>=RANGE_PROPS.length)throw new ParseError({code:"invalidRangeTooManyValues",message:"the array contains too many values",args:[state.type],index:state.valueIndex});result[RANGE_PROPS[e++]]=item}}}state.value=result.default,Object.assign(state.varResult,result)}function parseSelect(state){if(parseJSON(state),"object"!=typeof state.value||!state.value)throw new ParseError({code:"invalidSelect",message:"The value must be an array or object"});const options=Array.isArray(state.value)?state.value.map(key=>createOption(key)):Object.keys(state.value).map(key=>createOption(key,state.value[key]));if(new Set(options.map(e=>e.name)).size<options.length)throw new ParseError({code:"invalidSelectNameDuplicated",message:"Option name is duplicated"});if(0===options.length)throw new ParseError({code:"invalidSelectEmptyOptions",message:"Option list is empty"});const defaults=options.filter(e=>e.isDefault);if(defaults.length>1)throw new ParseError({code:"invalidSelectMultipleDefaults",message:"multiple default values"});options.forEach(e=>{delete e.isDefault}),state.varResult.options=options,state.value=(defaults.length>0?defaults[0]:options[0]).name}function parseVarXStyle(state){const pos=state.lastIndex;if("{"!==state.text[state.lastIndex])throw new MissingCharError(["{"],pos);const options=[];for(state.lastIndex++;"}"!==state.text[state.lastIndex];){const option={};parseStringUnquoted(state),option.name=state.value,parseString(state),option.label=state.value,"dropdown"===state.type?parseEOT(state):parseString(state),option.value=state.value,options.push(option)}if(state.lastIndex++,eatWhitespace(state),0===options.length)throw new ParseError({code:"invalidSelectEmptyOptions",message:"Option list is empty",index:pos});"dropdown"===state.type&&(state.varResult.type="select",state.type="select"),state.varResult.options=options,state.value=options[0].name}function createOption(label,value){if("string"!=typeof label||value&&"string"!=typeof value)throw new ParseError({code:"invalidSelectValue",message:"Values in the object/array must be strings"});let name,isDefault=!1;label.endsWith("*")&&(isDefault=!0,label=label.slice(0,-1));const match=label.match(/^(\w+):(.*)/);if(match&&([,name,label]=match),name||(name=label),!label)throw new ParseError({code:"invalidSelectLabel",message:"Option label is empty"});return null==value&&(value=name),{name,label,value,isDefault}}function collectErrors(e,errors){if(errors)try{e()}catch(e){errors.push(e)}else e()}function validateURL(state){let url;try{url=new URL(state.value)}catch(e){throw e.args=[state.value],e.index=state.valueIndex,e}if(!/^https?:/.test(url.protocol))throw new ParseError({code:"invalidURLProtocol",args:[url.protocol],message:`Invalid protocol: ${url.protocol}`,index:state.valueIndex})}function validateRange(state){const value=state.value;if("number"!=typeof value)throw new ParseError({code:"invalidRangeDefault",message:`the default value of @var ${state.type} must be a number`,index:state.valueIndex,args:[state.type]});const result=state.varResult;if(null!=result.min&&value<result.min)throw new ParseError({code:"invalidRangeMin",message:"the value is smaller than the minimum",index:state.valueIndex,args:[state.type]});if(null!=result.max&&value>result.max)throw new ParseError({code:"invalidRangeMax",message:"the value is larger than the maximum",index:state.valueIndex,args:[state.type]});if(null!=result.step&&[value,result.min,result.max].some(e=>null!=e&&!isMultipleOf(e,result.step)))throw new ParseError({code:"invalidRangeStep",message:"the value is not a multiple of the step",index:state.valueIndex,args:[state.type]});if(result.units&&!UNITS_SET.has(result.units))throw new ParseError({code:"invalidRangeUnits",message:`Invalid CSS unit: ${result.units}`,index:state.valueIndex,args:[state.type,result.units]})}function isMultipleOf(value,step){const e=Math.abs(value/step),nInt=Math.round(e);return Math.abs(e-nInt)<Math.pow(10,`${nInt}`.length-16)}function createParser({unknownKey="ignore",mandatoryKeys=MANDATORY_META,parseKey:userParseKey,parseVar:userParseVar,validateKey:userValidateKey,validateVar:userValidateVar,allowErrors=!1}={}){if(!["ignore","assign","throw"].includes(unknownKey))throw new TypeError("unknownKey must be 'ignore', 'assign', or 'throw'");const parser=Object.assign(Object.create(null),DEFAULT_PARSER,userParseKey),keysOfParser=[...Object.keys(parser),"advanced","var"],varParser=Object.assign({},DEFAULT_VAR_PARSER,userParseVar),validator=Object.assign({},DEFAULT_VALIDATOR,userValidateKey),varValidator=Object.assign({},DEFAULT_VAR_VALIDATOR,userValidateVar);return{parse:function(text){if(text.includes("\r"))throw new TypeError("metadata includes invalid character: '\\r'");const usercssData={},errors=[],e=/@([\w-]+)[^\S\r\n]*/gm,state={index:0,lastIndex:0,text,usercssData,warn:err=>errors.push(err)};let match;for(;match=e.exec(text);)state.index=match.index,state.lastIndex=e.lastIndex,state.key=match[1],state.shouldIgnore=!1,collectErrors(()=>{try{"var"===state.key||"advanced"===state.key?parseVar(state):parseKey(state)}catch(e){throw void 0===e.index&&(e.index=state.index),e}"var"===state.key||"advanced"===state.key||state.shouldIgnore||(usercssData[state.key]=state.value)},allowErrors&&errors),e.lastIndex=state.lastIndex;state.maybeUSO&&!usercssData.preprocessor&&(usercssData.preprocessor="uso");return collectErrors(()=>{const missing=mandatoryKeys.filter(e=>!Object.prototype.hasOwnProperty.call(usercssData,e)||!usercssData[e]);if(missing.length>0)throw new ParseError({code:"missingMandatory",args:missing,message:`Missing metadata: ${missing.map(e=>`@${e}`).join(", ")}`})},allowErrors&&errors),{metadata:usercssData,errors}},validateVar:function(varObject){e({key:"var",type:varObject.type,value:varObject.value,varResult:varObject})}};function e(state){const validate="object"==typeof varValidator[state.type]?varValidator[state.type][state.key]:varValidator[state.type];validate&&validate(state)}function parseVar(state){const result={type:null,label:null,name:null,value:null,default:null,options:null};state.varResult=result,parseWord(state),state.type=state.value,result.type=state.type;const doParse="object"==typeof varParser[state.type]?varParser[state.type][state.key]:varParser[state.type];if(!doParse)throw new ParseError({code:"unknownVarType",message:`Unknown @${state.key} type: ${state.type}`,args:[state.key,state.type],index:state.index});parseWord(state),result.name=state.value,parseString(state,!0),result.label=state.value,state.valueIndex=state.lastIndex,doParse(state),e(state),result.default=state.value,state.usercssData.vars||(state.usercssData.vars={}),state.usercssData.vars[result.name]=result,"advanced"===state.key&&(state.maybeUSO=!0)}function parseKey(state){let doParse=parser[state.key];if(!doParse){if("assign"!==unknownKey){if(eatLine(state),"ignore"===unknownKey)return void(state.shouldIgnore=!0);const MAX_EDIT=Math.log2(state.key.length),maybeSuggestion=keysOfParser.find(metaKey=>LevenshteinDistanceWithMax(metaKey,state.key,MAX_EDIT));throw new ParseError({code:"unknownMeta",args:[state.key,maybeSuggestion],message:`Unknown metadata: @${state.key}${maybeSuggestion?`, did you mean @${maybeSuggestion}?`:""}`,index:state.index})}doParse=parseStringToEnd}state.valueIndex=state.lastIndex,doParse(state),validator[state.key]&&validator[state.key](state)}}function normalizeVersion(version){return"v"===version[0]||"="===version[0]?version.slice(1):version}module.exports={parse:(text,options)=>createParser(options).parse(text),createParser,isMultipleOf}},93:module=>{function createStringifier({alignKeys=!1,space=2,format="stylus",stringifyKey:userStringifyKey={},stringifyVar:userStringifyVar={}}={}){return{stringify:function(meta){let varKey;if("stylus"===format)varKey="var";else{if("xstyle"!==format)throw new TypeError("options.format must be 'stylus' or 'xstyle'");varKey="advanced"}const lines=[];for(const key of Object.keys(meta)){const value=meta[key];if(Object.prototype.hasOwnProperty.call(userStringifyKey,key)){const result=userStringifyKey[key](value);Array.isArray(result)?lines.push.apply(lines,result.map(e=>[key,e])):lines.push([key,result])}else if("vars"===key)for(const e of Object.values(value))lines.push([varKey,stringifyVar(e,format,userStringifyVar,space)]);else if(Array.isArray(value))for(const subLine of value)lines.push([key,quoteIfNeeded(subLine)]);else lines.push([key,quoteIfNeeded(value)])}const maxKeyLength=alignKeys?Math.max.apply(null,lines.map(e=>e[0].length)):0;return`/* ==UserStyle==\n${text=lines.map(([key,text])=>`@${key.padEnd(maxKeyLength)} ${text}`).join("\n"),text.replace(/\*\//g,"*\\/")}\n==/UserStyle== */`;var text}}}function stringifyVar(e,format,userStringifyVar,space){return`${function(){if("xstyle"===format&&"select"===e.type)return"dropdown";return e.type}()} ${e.name} ${JSON.stringify(e.label)} ${function(){if(Object.prototype.hasOwnProperty.call(userStringifyVar,e.type))return userStringifyVar[e.type](e,format,space);if(e.options)return"stylus"===format?JSON.stringify(e.options.reduce((object,opt)=>(object[`${opt.name}:${opt.label}${opt.name===e.default?"*":""}`]=opt.value,object),{}),null,space):stringifyEOT(e.options,"image"===e.type,space);if("text"===e.type&&"xstyle"===format)return JSON.stringify(e.default);if("number"===e.type||"range"===e.type){const output=[e.default,e.min,e.max,e.step];return e.units&&output.push(e.units),JSON.stringify(output)}return e.default}()}`}function quoteIfNeeded(text){return"string"==typeof text&&text.includes("\n")?JSON.stringify(text):text}function stringifyEOT(options,singleLine=!1,space=0){const pad="string"==typeof space?space:" ".repeat(space);return`{\n${options.map(e=>`${pad}${e.name} ${JSON.stringify(e.label)} ${oValue(e.value)}`).join("\n")}\n}`;function oValue(value){return singleLine?JSON.stringify(value):`<<<EOT\n${value} EOT;`}}module.exports={stringify:(meta,options)=>createStringifier(options).stringify(meta),createStringifier}},541:(e,exports)=>{exports.URL=self.URL}},n={};function a(e){var s=n[e];if(void 0!==s)return s.exports;var module=n[e]={exports:{}};return t[e](module,module.exports,a),module.exports}a.d=(exports,definition)=>{for(var key in definition)a.o(definition,key)&&!a.o(exports,key)&&Object.defineProperty(exports,key,{enumerable:!0,get:definition[key]})},a.o=(obj,prop)=>Object.prototype.hasOwnProperty.call(obj,prop);var s={};(()=>{var t=a(988);const KEY="importScriptsOnce",importScriptsOnce=e[KEY],n=new Set(["default","uso","stylus","less"]),options={validateKey:{preprocessor:state=>{if(!n.has(state.value))throw new t.ParseError({code:"unknownPreprocessor",args:[state.value],index:state.valueIndex})}},validateVar:{select:state=>{if(state.varResult.options.every(e=>e.name!==state.value))throw new t.ParseError({code:"invalidSelectValueMismatch",index:state.valueIndex})},color:state=>{importScriptsOnce("color-converter.js");const color=colorConverter.parse(state.value);if(!color)throw new t.ParseError({code:"invalidColor",args:[state.value],index:state.valueIndex});state.value=colorConverter.format(color)}}},parser=t.createParser(options),r={lint:t.createParser(Object.assign({},options,{allowErrors:!0,unknownKey:"throw"})).parse,parse:parser.parse,nullifyInvalidVars(vars){for(const e of Object.values(vars))if(null!==e.value)try{parser.validateVar(e)}catch{e.value=null}return vars}};a.d(s,{default:()=>r})})(),self.metaParser=s.default})()}